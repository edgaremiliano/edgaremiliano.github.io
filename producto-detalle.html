<!DOCTYPE HTML>
<html lang="es-MX">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- El título y las metas se actualizarán con JavaScript -->
    <title>Detalle del Producto | OPNATUR</title>
    <meta name="description" content="Detalles sobre nuestro producto. Conoce sus beneficios y modo de uso." />
    <meta property="og:type" content="website">
    <meta property="og:title" content="Detalle del Producto | OPNATUR">
    <meta property="og:site_name" content="OPNATUR" />
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Detalle del Producto | OPNATUR">

    <link type="image/x-icon" href="img/Content/ajolotius-1-fbfa2eaf.ico" rel="icon" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" />
    <link rel="stylesheet" href="resources/frontend/css/globalc599.css?2025-08-07%2013:34:42">
    <link rel="stylesheet" href="resources/frontend/lib/aos/aos.css" />

    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-56TJ3T4H');
    </script>
    <!-- End Google Tag Manager -->
    <style>
        /* Estilos específicos para la página de detalle */
        
        .product-detail-image {
            width: 100%;
            max-width: 500px;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            display: block;
        }
        
        .benefits-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .benefits-list li {
            position: relative;
            padding-left: 25px;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .benefits-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #19ab48;
            /* Verde primario */
            font-weight: bold;
        }
    </style>
</head>

<body class="header-home">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-56TJ3T4H" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="preloader" class="js-preloader">
        <div class="loader"></div>
    </div>
    <div class="hide-menu"></div>

    <!-- ===== HEADER COMPLETO ===== -->
    <header>
        <div class="container1600">
            <div class="row between-xl middle-xl relative">
                <figure class="logo px-1">
                    <a href="index.html">
                        <img src="img/Content/ajolotius-logo-web.png" alt="Ajolotius" width="125" height="124">
                    </a>
                </figure>
                <div class="navigation px-1 px-0-lc">
                    <nav id="main-nav">
                        <ul id="main-menu" class="sm sm-simple" class="level-0">
                            <li><a href="index.html">Inicio</a></li>
                            <li><a href="nuestra-tienda.html">Nuestra tienda</a></li>
                            <li><a href="productos.html">Productos</a>
                                <ul class="level-1">
                                    <li><a href="c/linea-blife.html">Blife</a></li>
                                    <li><a href="c/linea-prosa.html">Prosa</a></li>
                                    <li><a href="c/linea-gn-vida.html">Gn+Vida</a></li>
                                    <li><a href="c/linea-naturaldry.html">NaturalDry</a></li>
                                    <li><a href="c/linea-ypenza.html">Ypenza</a></li>
                                </ul>
                            </li>
                            <li><a href="dudas.html">Dudas</a></li>
                            <li><a href="contacto.html">Contacto</a></li>
                        </ul>
                    </nav>
                    <span class="close-menu"><i class="icon-close"></i></span>
                </div>
                <div class="show1024 px-1-lc">
                    <button type="button" class="navbar-toggler ml-05-lc">
                    <i class="icon-menu"></i>
                </button>
                </div>
            </div>
        </div>
    </header>

    <main class="pt-5">
        <div class="container1600 my-4">
            <!-- BOTÓN DE REGRESO CON ID AÑADIDO -->
            <div class="mb-2">
                <a href="productos.html" id="back-to-category-link" class="c-gray fsize18" style="text-decoration: none;">
                    <i class="icon-arrow-light-left"></i> Volver a Productos
                </a>
            </div>
            <div id="product-content" class="row middle-xl">
                <!-- Columna de la Imagen -->
                <div class="col-xl-6 col-md-12" data-aos="fade-right">
                    <img id="product-image" src="img/Content/placeholder.png" alt="Cargando producto..." class="product-detail-image">
                </div>

                <!-- Columna de la Información -->
                <div class="col-xl-6 col-md-12" data-aos="fade-left">
                    <h1 id="product-name" class="title-large-1 black">Cargando...</h1>
                    <p id="product-presentation" class="fsize20 c-gray"></p>
                    <p id="product-price" class="product-price" style="font-size: 2.5rem; color: #19ab48;"></p>

                    <h3 class="mt-2 fsize22 black">Beneficios:</h3>
                    <ul id="product-benefits" class="benefits-list"></ul>

                    <h3 class="mt-2 fsize22 black">Modo de Uso:</h3>
                    <p id="product-usage" class="fsize18"></p>

                    <!-- El ID del botón se mantiene, pero la clase ahora es la correcta -->
                    <button id="add-to-cart-btn" class="btn-add-to-cart mt-2" style="max-width: 300px; padding: 15px;">Agregar al pedido</button>
                </div>
            </div>
        </div>
    </main>
    <!-- ===== FOOTER COMPLETO ===== -->
    <footer class="relative bg-dark-gray c-white ">
        <div class="container bb-1 b-gray py-2 m ">
            <div class="row middle-xl ">
                <div class="col-xl col-md-12 d-flex-xl middle-xl ">
                    <figure>
                        <img src="img/Content/ajolotius-1-fbfa2eaf.ico" loading="lazy" alt="Redes Sociales" width="40" height="40">
                    </figure>
                    <div class="ml-1 ">
                        <h4 class="black fsize18 ">¡Síguenos en Redes Sociales!</h4>
                        <p>Mantente al día con nuestras últimas noticias, productos y promociones especiales.</p>
                    </div>
                </div>
                <div class="col-xl-5 col-md-12 mt-1-md text-center-xl text-left-md">
                    <div class="nav-social d-flex-xl center-xl">
                        <a href="https://www.facebook.com/profile.php?id=61566248320833" target="_blank" class="bg-facebook" style="font-size: 1.5rem; margin: 0 15px;"><i class="icon-facebook"></i></a>
                        <a href="https://x.com/op_natur64628" target="_blank" class="bg-twitter" style="font-size: 1.5rem; margin: 0 15px;"><i class="icon-twitter"></i></a>
                        <a href="https://www.youtube.com/@OpNatur" target="_blank" class="bg-youtube" style="font-size: 1.5rem; margin: 0 15px;"><i class="icon-youtube"></i></a>
                        <a href="https://www.instagram.com/opnat_ur?igsh=NDJzOWx3MnMybWU2" target="_blank" class="bg-instagram" style="font-size: 1.5rem; margin: 0 15px;"><i class="icon-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container pt-2 accordion " id="accordion-footer ">
            <div class="row ">
                <div class="col-xl-3 col-mg-4 col-md-12 mb-1-md ">
                    <h5 class="fsize18 extra-bold tb-bottom tb-primary tb-3 mb-1 ">opnaturcontactt@gmail.com</h5>
                </div>
                <div class="col-xl-6 col-mg-5 col-md-12 px-0-md ">
                    <ul class="deploy-footer foot-menu d-flex-xl flex-wrap-xl p-1-md ">
                        <li class="col-xl-6 px-0 "><a class="d-flex-xl " href="index.html "><i class="icon-arrow-light-next mr-05 "></i> Inicio</a></li>
                        <li class="col-xl-6 px-0 "><a class="d-flex-xl " href="nuestra-tienda.html"><i class="icon-arrow-light-next mr-05 "></i> Nuestra tienda</a></li>
                        <li class="col-xl-6 px-0 "><a class="d-flex-xl " href="productos.html "><i class="icon-arrow-light-next mr-05 "></i> Productos</a></li>
                        <li class="col-xl-6 px-0 "><a class="d-flex-xl " href="dudas.html "><i class="icon-arrow-light-next mr-05 "></i> Dudas</a></li>
                        <li class="col-xl-6 px-0 "><a class="d-flex-xl " href="contacto.html "><i class="icon-arrow-light-next mr-05 "></i> Contacto</a></li>
                    </ul>
                </div>
                <div class="col-xl-3 col-md-12 px-0-md ">
                    <h5 class="fsize18 extra-bold d-flex-xl between-xl middle-xl ">Información</h5>
                    <ul class="deploy-footer p-1-md ">
                        <li><a class="d-flex-xl " href="terminos-condiciones.html "><i class="icon-arrow-light-next mr-05 "></i> Términos y condiciones</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="bg-black py-1 fsize14 ">
            <div class="container px-1 ">
                <p class="text-center c-white ">OPNATUR® y su distintivo lema son propiedad registrada. Año 2025. Todos los derechos reservados. </p>
            </div>
        </div>
    </footer>

    <!-- ===== SCRIPTS COMUNES ===== -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script async src="resources/frontend/js/global.minf961.js?2025-08-07%2013:34:36 "></script>
    <script src="resources/frontend/lib/preload/jquery.preloadinator.min.js "></script>
    <script src="resources/frontend/lib/lazyload/lazysizes.min.js " async=" "></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
    <script src="https://unpkg.com/aos@3.0.0-beta.6/dist/aos.js"></script>
    <script>
        $('.js-preloader').preloadinator({
            minTime: 500
        });
        AOS.init({
            startEvent: 'DOMContentLoaded'
        });
    </script>
    <!-- ===== SCRIPT PARA CARGAR DATOS DEL PRODUCTO ===== -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const params = new URLSearchParams(window.location.search);
            const productId = params.get('id');
            const mainContent = document.getElementById('product-content');

            if (!productId) {
                mainContent.innerHTML = '<h1 class="text-center title-large-1 black">Producto no encontrado.</h1>';
                return;
            }

            // ===== INICIA LÓGICA PARA EL BOTÓN DE REGRESO DINÁMICO =====
            const backButton = document.getElementById('back-to-category-link');
            let categoryPrefix = productId.split('-')[0]; // Obtiene la categoría del ID
            if (productId.startsWith('gn-vida') || productId.startsWith('hierro-vitaminas')) {
                categoryPrefix = 'gn-vida';
            }

            const categoryMap = {
                'blife': {
                    name: 'Blife',
                    url: 'c/linea-blife.html'
                },
                'prosa': {
                    name: 'Prosa',
                    url: 'c/linea-prosa.html'
                },
                'gn-vida': {
                    name: 'Gn+Vida',
                    url: 'c/linea-gn-vida.html'
                },
                'naturaldry': {
                    name: 'NaturalDry',
                    url: 'c/linea-naturaldry.html'
                },
                'ypenza': {
                    name: 'Ypenza',
                    url: 'c/linea-ypenza.html'
                }
            };

            if (categoryMap[categoryPrefix]) {
                const category = categoryMap[categoryPrefix];
                backButton.href = category.url;
                backButton.innerHTML = `<i class="icon-arrow-light-left"></i> Volver a Productos ${category.name}`;
            }
            // Si no encuentra una categoría, se queda el enlace por defecto a "productos.html"
            // ===== TERMINA LÓGICA PARA EL BOTÓN DE REGRESO DINÁMICO =====


            fetch('productos.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    const product = data.find(p => p.id === productId);

                    if (!product) {
                        mainContent.innerHTML = '<h1 class="text-center title-large-1 black">Producto no encontrado.</h1>';
                        return;
                    }

                    // Rellenar la plantilla con los datos
                    document.getElementById('product-image').src = product.imagen;
                    document.getElementById('product-image').alt = product.nombre;
                    document.getElementById('product-name').textContent = product.nombre;
                    document.getElementById('product-presentation').textContent = product.presentacion;
                    // Usa el precio de display para mostrarlo en la página
                    document.getElementById('product-price').textContent = new Intl.NumberFormat('es-MX', {
                        style: 'currency',
                        currency: 'MXN'
                    }).format(product.precio_display);
                    document.getElementById('product-usage').textContent = product.modo_uso;

                    const benefitsList = document.getElementById('product-benefits');
                    benefitsList.innerHTML = ''; // Limpiar por si acaso
                    product.beneficios.forEach(benefit => {
                        const li = document.createElement('li');
                        li.textContent = benefit;
                        benefitsList.appendChild(li);
                    });

                    // Configurar el botón de "Agregar al pedido"
                    const addToCartBtn = document.getElementById('add-to-cart-btn');
                    addToCartBtn.setAttribute('data-name', product.nombre);
                    addToCartBtn.setAttribute('data-size', product.presentacion);
                    // Usamos el precio del JSON para el carrito
                    addToCartBtn.setAttribute('data-price', product.precio_carrito);

                    // Actualizar metadatos para SEO
                    document.title = `${product.nombre} | OPNATUR`;
                    document.querySelector('meta[name="description"]').setAttribute('content', product.modo_uso);
                    document.querySelector('meta[property="og:title"]').setAttribute('content', `${product.nombre} | OPNATUR`);
                    document.querySelector('meta[property="twitter:title"]').setAttribute('content', `${product.nombre} | OPNATUR`);
                })
                .catch(error => {
                    console.error('Error al cargar los datos del producto:', error);
                    mainContent.innerHTML = '<h1 class="text-center title-large-1 black">Error al cargar la información.</h1>';
                });
        });
    </script>


    <!-- ===== SCRIPT DEL CARRITO (CORREGIDO) ===== -->
    <div id="cart-float" data-fancybox data-src="#cart-box">
        <!-- Ícono de carrito SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 16 16">
            <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
        </svg>
        <!-- Contador de productos -->
        <span id="cart-counter">0</span>
    </div>

    <!-- 2. Ventana Emergente (Modal) del Carrito -->
    <div id="cart-box" style="display: none; max-width: 500px;">
        <h2 class="title-small-2 black c-secondary title-decor-center">Mi Pedido</h2>
        <div id="cart-items" class="my-2">
            <!-- Los productos se insertarán aquí con JavaScript -->
            <p class="text-center">Tu carrito está vacío.</p>
        </div>
        <div id="cart-total" class="text-right fsize20 extra-bold my-2">
            <!-- El total se insertará aquí -->
        </div>
        <button id="send-order-btn" class="btn-primary btn-block">Enviar pedido por WhatsApp</button>
    </div>
    <script>
        $(document).ready(function() {
            let pedido = [];
            const whatsappNumber = '5575071070'; // Tu número de WhatsApp

            const formatCurrency = (value) => new Intl.NumberFormat('es-MX', {
                style: 'currency',
                currency: 'MXN'
            }).format(value);

            function updateCartCounter() {
                const totalItems = pedido.reduce((sum, item) => sum + item.quantity, 0);
                $('#cart-counter').text(totalItems);
            }

            function renderCartItems() {
                const cartItemsContainer = $('#cart-items');
                const cartTotalContainer = $('#cart-total');
                cartItemsContainer.empty();
                cartTotalContainer.empty();

                if (pedido.length === 0) {
                    cartItemsContainer.html('<p class="text-center">Tu carrito está vacío.</p>');
                    cartTotalContainer.empty();
                    return;
                }

                let totalPedido = 0;

                pedido.forEach((item, index) => {
                    const subtotal = item.price * item.quantity;
                    totalPedido += subtotal;

                    const itemHTML = `
        <div class="cart-item">
            <div class="cart-item-details">
                <strong>${item.name}</strong><br>
                <small>${item.size} - ${formatCurrency(item.price)} c/u</small>
            </div>
            <div class="cart-item-actions">
                <button class="btn-update-quantity" data-index="${index}" data-change="-1">-</button>
                <span class="mx-1">${item.quantity}</span>
                <button class="btn-update-quantity" data-index="${index}" data-change="1">+</button>
            </div>
            <div class="cart-item-price ml-1">${formatCurrency(subtotal)}</div>
        </div>`;
                    cartItemsContainer.append(itemHTML);
                });

                cartTotalContainer.html(`<strong>Total: ${formatCurrency(totalPedido)}</strong>`);
            }

            $('body').on('click', '.btn-add-to-cart', function(e) {
                e.preventDefault();
                e.stopPropagation();

                const name = $(this).data('name');
                const size = $(this).data('size');
                const price = parseFloat($(this).data('price'));
                const existingItem = pedido.find(item => item.name === name && item.size === size);

                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    pedido.push({
                        name,
                        size,
                        price,
                        quantity: 1
                    });
                }

                updateCartCounter();
                renderCartItems();

                const button = $(this);
                const originalText = button.text();
                button.text('¡Agregado!').addClass('added').prop('disabled', true);
                setTimeout(() => {
                    button.text(originalText).removeClass('added').prop('disabled', false);
                }, 1000);
            });

            $('#cart-box').on('click', '.btn-update-quantity', function() {
                const index = $(this).data('index');
                const change = parseInt($(this).data('change'));
                pedido[index].quantity += change;
                if (pedido[index].quantity <= 0) {
                    pedido.splice(index, 1);
                }
                updateCartCounter();
                renderCartItems();
            });

            $('#cart-float').on('click', function() {
                renderCartItems();
            });

            $('#send-order-btn').on('click', function() {
                if (pedido.length === 0) {
                    alert('Tu carrito está vacío. Agrega productos para hacer un pedido.');
                    return;
                }
                let totalPedido = 0;
                let message = 'Hola, me gustaría hacer el siguiente pedido:\n\n';
                pedido.forEach(item => {
                    const subtotal = item.price * item.quantity;
                    totalPedido += subtotal;
                    message += `- ${item.name} (${item.size})\n  Cantidad: ${item.quantity} x ${formatCurrency(item.price)} = ${formatCurrency(subtotal)}\n\n`;
                });
                message += `*Total del Pedido: ${formatCurrency(totalPedido)}*\n\n¡Gracias!`;
                const whatsappUrl = `https://api.whatsapp.com/send?phone=${whatsappNumber}&text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            });
        });
    </script>

</body>

</html>
